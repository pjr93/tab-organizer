<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Board with Split Insert Zones</title>
<style>
body { font-family: Arial, sans-serif; margin: 0; background:#f8f9fB;}
#parent-row {
  display: flex;
  flex-direction: row;
  gap: 8px;
  margin: 40px 20px;
  align-items: flex-start;
}
.child-grid {
  background: #fff;
  border: 2px solid #666;
  border-radius: 8px;
  padding: 10px;
  min-width: 140px;
  min-height: 150px;
  display: grid;
  grid-template-columns: repeat(2, 120px);
  grid-auto-rows: 70px;
  gap: 10px;
  position: relative;
  box-shadow: 0 2px 6px #0002;
}
.grid-item {
  background: #59c96e;
  color: white;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: move;
  user-select: none;
  font-weight: bold;
  position: relative;
  padding: 4px 0;
}
.delete-btn {
  display: none;
  position: absolute;
  top: 3px; right: 6px;
  background: #e53e3e;
  border: none;
  color: #fff; font-weight:bold;
  border-radius: 50%;
  width: 18px; height: 18px; cursor:pointer; font-size:16px; line-height:15px; padding:0;
}
.grid-item:hover .delete-btn { display: block; }
.insertion-zone {
  width: 28px; /* or 100% height, if vertical columns */
  height: 150px;
  margin: 0 6px;
  border-radius: 10px;
  background: transparent;
  border: 2px dashed #bbb;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background .18s, border-color .18s;
  cursor: pointer;
  position:relative;
  z-index:2;
}
.insertion-zone.active {
  background: #d0e7f9;
  border-color: #2196F3;
}
</style>
</head>
<body>
<h2 style="margin:20px 0 0 20px;">Visual Split Drag Board</h2>
<!-- The parent holds grids and horizontal insertion zones between -->
<div id="parent-row"></div>

<script>
const parentRow = document.getElementById('parent-row');
let draggedItem = null;

// Sample initial data
const groupData = [
  ["Alpha", "Beta"],
  ["Gamma", "Delta"],
];

// ----------------------------------
// Utility: create a grid group
function createGrid(items=[]) {
  const grid = document.createElement('div');
  grid.className = 'child-grid';

  // Drag-over for highlighting (normal, not for insertion)
  grid.addEventListener('dragover', e => e.preventDefault());
  grid.addEventListener('drop', function(e){
    e.preventDefault();
    if (draggedItem) {
      this.appendChild(draggedItem);
    }
    clearActiveZones();
  });

  items.forEach(txt=>{
    grid.appendChild(createGridItem(txt));
  });
  return grid;
}

// ----------------------------------
// Utility: create draggable item
function createGridItem(text){
  const item = document.createElement('div');
  item.className = 'grid-item';
  item.textContent = text;
  item.draggable = true;

  // Delete button
  const btn = document.createElement('button');
  btn.className = 'delete-btn'; btn.textContent = 'Ã—';
  btn.onclick = e => {
    e.stopPropagation(); item.remove();
  };
  item.appendChild(btn);

  item.addEventListener('dragstart', e=>{
    draggedItem = item;
    setTimeout(()=>item.style.display='none',0);
  });
  item.addEventListener('dragend', e=>{
    if(item) item.style.display='flex';
    draggedItem = null;
    clearActiveZones();
  });
  return item;
}

// ----------------------------------
// Utility: create an insertion zone
function createInsertionZone(idx){
  const zone = document.createElement('div');
  zone.className = 'insertion-zone';

  // Highlight when a dragged item enters
  zone.addEventListener('dragover', e=>{
    e.preventDefault(); zone.classList.add('active');
  });
  zone.addEventListener('dragenter', e=>{
    e.preventDefault(); zone.classList.add('active');
  });
  zone.addEventListener('dragleave', e=>{
    zone.classList.remove('active');
  });
  // Drop here to insert a new grid at idx
  zone.addEventListener('drop', e=>{
    e.preventDefault();
    zone.classList.remove('active');
    if (draggedItem){
      // Remove dragged from wherever it was
      if(draggedItem.parentElement) draggedItem.parentElement.removeChild(draggedItem);
      // Insert new grid at position idx
      insertNewGrid(idx, draggedItem);
    }
    clearActiveZones();
  });
  return zone;
}

// ----------------------------------
// Remove highlights from all insertion zones
function clearActiveZones(){
  document.querySelectorAll('.insertion-zone').forEach(z=>z.classList.remove('active'));
}

// ----------------------------------
// Renders the board: grids and insertion zones
function renderBoard() {
  // Clear all
  parentRow.innerHTML = '';
  const grids = groupData.map(items=>createGrid(items));
  // Render: [zone][grid][zone][grid]...[zone]
  for(let i=0; i<=grids.length; i++){
    const zone = createInsertionZone(i);
    parentRow.appendChild(zone);
    if(i<grids.length){
      parentRow.appendChild(grids[i]);
    }
  }
}

// Insert a new grid at idx position, with the item inside
function insertNewGrid(idx, item){
  groupData.splice(idx, 0, [item.textContent]);
  renderBoard();
}

// ----------- Initialization
// Convert initial group data to board
renderBoard();
// Enable dragging for existing/new grid items
window.addEventListener('DOMContentLoaded',()=>{
  // add-on: click to add to group 1 for demo
  document.body.insertAdjacentHTML('beforeend', `
    <button style="position:fixed;top:5px;right:10px;" onclick="addDemoItem()">Add Item</button>
  `);
  window.addDemoItem = function(){
    if(groupData.length===0) groupData.push([]);
    groupData[0].push('NewItem'+Math.floor(Math.random()*100));
    renderBoard();
  }
});

</script>
</body>
</html>
